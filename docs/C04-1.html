<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 3: The Ecosystem Model | GLM Workbook</title>
  <meta name="description" content="The Online GLM Workbook" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 3: The Ecosystem Model | GLM Workbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Online GLM Workbook" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 3: The Ecosystem Model | GLM Workbook" />
  
  <meta name="twitter:description" content="The Online GLM Workbook" />
  

<meta name="author" content="Matt Hipsey, Giles Knight, Casper Boon, Dan Paraska" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="C03-1.html"/>
<link rel="next" href="C05-1.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="https://hypothes.is/embed.js" async></script>
  


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>GLM Workbook</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#excel"><i class="fa fa-check"></i>Excel</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#unzipping-files"><i class="fa fa-check"></i>Unzipping files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="C02-1.html"><a href="C02-1.html"><i class="fa fa-check"></i>Module 1: Getting Started with GLM</a>
<ul>
<li class="chapter" data-level="" data-path="C02-1.html"><a href="C02-1.html#C02_2"><i class="fa fa-check"></i>Module Resources</a></li>
<li class="chapter" data-level="" data-path="C02-1.html"><a href="C02-1.html#C02_3"><i class="fa fa-check"></i>Setting up GLM</a></li>
<li class="chapter" data-level="" data-path="C02-1.html"><a href="C02-1.html#C02_7"><i class="fa fa-check"></i>Anatomy of a Simulation</a></li>
<li class="chapter" data-level="" data-path="C02-1.html"><a href="C02-1.html#C02_8"><i class="fa fa-check"></i>Exercise: Lake-scale Water &amp; Heat Balance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="C03-1.html"><a href="C03-1.html"><i class="fa fa-check"></i>Module 2: Configuring Model Parameters</a>
<ul>
<li class="chapter" data-level="" data-path="C03-1.html"><a href="C03-1.html#C03_2"><i class="fa fa-check"></i>Getting Familiar with the .nml</a></li>
<li class="chapter" data-level="" data-path="C03-1.html"><a href="C03-1.html#C03_3"><i class="fa fa-check"></i>Exercise: Adding Output Points</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="C04-1.html"><a href="C04-1.html"><i class="fa fa-check"></i>Module 3: The Ecosystem Model</a></li>
<li class="chapter" data-level="" data-path="C05-1.html"><a href="C05-1.html"><i class="fa fa-check"></i>Module 4L Assessing Error &amp; Sensitivity</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GLM Workbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="C04_1" class="section level1 unnumbered">
<h1>Module 3: The Ecosystem Model</h1>
<center>
<img src="images/09-module8/picture1.jpg" width="75%" />
</center>
<p>The <em>Kinneret97</em> model simulation above has the ecological model aed2 enabled. It has been pre- configured to run the customizable <a href="http://aquatic.science.uwa.edu.au/research/models/AED/modules.html">AED modules</a>. These are separate models, but have been set up to run side by side. They are configured using the text file <code>aed2.nml</code>.</p>

<div class="rmdnote2">
<p>The above simulation was only plotting temperature and salinity and these plots were configured in <code>plots.nml</code>. Open <code>plots.nml</code> to see how you can customise the graphs. There are many other variables we may be interested in plotting when we run the watter quality model such as oxygen, nutrients, and algae. A pre-configured file called <code>plots_aed2.nml</code> has been created. To use this file, rename it to <code>plots.nml</code> (you’ll first need to rename the existing <code>plots.nml</code>) and run the model. You should now see more outputs for the lake simulation.</p>
</div>
<p>Let’s also now add water quality variables to the specific depth output files (i.e. <code>WQ_5.csv</code>). To do so we must edit the output section of the <code>glm3.nml</code> file, by adding the variables as extra columns to the <code>.csv</code> file that were configured above.</p>

<div class="rmdtip2">
If they are there already, make sure that the number of variables is high enough to include them all.
</div>
<p>In <code>plots.nml</code> the required variables are all listed, make sure the number of plots is high enough to include them all.</p>
<center>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:250px; overflow-x: scroll; width:100%; ">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table04-4">Table 1: </span>Water quality variables and their descriptions.
</caption>
<thead>
<tr>
<th style="text-align:center;">
Description
</th>
<th style="text-align:center;">
Variable Name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;min-width: 25em; ">
Passive tracer
</td>
<td style="text-align:center;min-width: 25em; ">
<code>TRC_tr1</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Water age
</td>
<td style="text-align:center;min-width: 25em; ">
<code>TRC_age</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Suspended solids
</td>
<td style="text-align:center;min-width: 25em; ">
<code>NCS_ss1</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved oxygen
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OXY_oxy</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved inorganic carbon
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_dic</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
pH
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_pH</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Methane (dissolved)
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_ch4</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Methane (bubbles)
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_ch4_bub</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Reactive Silica
</td>
<td style="text-align:center;min-width: 25em; ">
<code>SIL_rsi</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Ammonium
</td>
<td style="text-align:center;min-width: 25em; ">
<code>NIT_amm</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Nitrate/Nitrite
</td>
<td style="text-align:center;min-width: 25em; ">
<code>NIT_nit</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Phosphate
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHS_frp</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particulate inorganic phosphorus
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHS_frp_ads</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic carbon
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_doc</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particualte organic carbon
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_poc</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic nitrogen
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_don</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic nitrogen
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_pon</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particualte organic phosphorus
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_dop</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic phsophorus
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_pop</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Green algae
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_green</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Green algae
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_green_IN</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Green algae
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_green_IP</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Diatoms
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_diatom</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Diatoms
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_diatom_IN</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Diatoms
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_diatom_IP</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Cyrptophytes
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_crypto</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Cyrptophytes
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_crypto_IN</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Cyrptophytes
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_crypto_IP</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Zooplankton
</td>
<td style="text-align:center;min-width: 25em; ">
<code>ZOO_zoo01</code>
</td>
</tr>
</tbody>
</table>
</div>
</center>
<p><br></p>
<p>Now run the model as above by double clicking the <code>glm.bat</code>.</p>
<ol style="list-style-type: decimal">
<li>Create a well formatted, interesting graph of variables of your choice (for example, you may like to consider all of the phytoplankton groups, all of the nitrogen variables, or create sums of these to generate a NPZD model) to see how they interact and change over time. If any variables are much bigger or smaller than the others, then use two y-axes or multiple plots.</li>
<li>How would these concentrations change if the air temperature increased by 2°C?
(You will need to edit the <code>met_hourly.csv</code> file). Make sure to save with correct date format, taking note these met measurements are recorded hourly, so YYYY-MM-DD hh:mm. A pre-made version of this file can be found in <em>bcs</em> which is called <code>met_1997_2004_airT2.csv</code>. To use this file, update <code>meteo_fl = 'bcs/met_1997_2004.csv'</code> in the <code>&amp;meteorology</code> section of <code>glm3.nml</code>.</li>
</ol>
<pre style="max-height: 239px;"><code>!-------------------------------------------------------------------------------
! meteorology
!-------------------------------------------------------------------------------
&amp;meteorology
   met_sw      = .true.
   lw_type     = &#39;LW_IN&#39;
   rain_sw     = .false.
   atm_stab    = 0
   fetch_mode  = 0
  !rad_mode    = 1
   albedo_mode = 1
   cloud_mode  = 4
   !-- BC file details
   subdaily    = .true.
   meteo_fl    = &#39;bcs/met_1997_2004.csv&#39; &lt;------- Update this!
   wind_factor = 0.9
   lw_factor   = 1.0
   lw_offset   = 0.0
   !-- Parameters
   ce = 0.0013
   ch = 0.0013
   cd  = 0.0013
  !catchrain      = .true.
  !rain_threshold = 0.001
  !runoff_coef    = 0.0
/</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>What happens if we change the water clarity? Increase and decrease from the original value to see the response</li>
</ol>

<div class="rmdtip2">
You must change the light extinction coefficient <code>Kw</code> (range 0-1) in the <code>glm3.nml</code> file.
</div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="C03-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="C05-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Module 8 Resources.zip", "Module 8 Resources"]],
"toc": {
"collapse": "none"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
